{"version":3,"sources":["../src/build.js"],"names":["debug","require","opts","cwd","process","entry","babel","__dirname","paths","Promise","resolve","config","JSON","stringify","webpackConfig","success","fail","err","console","log"],"mappings":";;;;;;;;;AAAA;;AACA;;AAGA;;AACA;;AACA;;AACA;;AALA;AACA;AAMA,IAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAAP,CAAiB,WAAjB,CAAd;;AAEe,oBAAoB;AAAA,MAAXC,IAAW,uEAAJ,EAAI;AAAA,kBACMA,IADN,CACzBC,GADyB;AAAA,MACzBA,GADyB,0BACnBC,OAAO,CAACD,GAAR,EADmB;AAAA,MACJE,KADI,GACMH,IADN,CACJG,KADI;AAGjC,MAAMC,KAAK,GAAG,mBAAQC,SAAR,EAAmB,wBAAnB,CAAd;AACA,MAAMC,KAAK,GAAG,0BAASL,GAAT,CAAd,CAJiC,CAKjC;AAEA;AACA;;AAEA,SAAO,IAAIM,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC5B;AACA,mCAAcJ,KAAd,EAAqB;AACnBH,MAAAA,GAAG,EAAHA;AADmB,KAArB,EAF4B,CAM5B;;AAN4B,yBAOT,gCAAc;AAAEA,MAAAA,GAAG,EAAHA;AAAF,KAAd,CAPS;AAAA,QAOpBQ,MAPoB,kBAOpBA,MAPoB;;AAQ5BX,IAAAA,KAAK,wBAAiBY,IAAI,CAACC,SAAL,CAAeF,MAAf,CAAjB,EAAL,CAR4B,CAU5B;;AACA,QAAMG,aAAa,GAAG,kCAAiB;AACrCX,MAAAA,GAAG,EAAHA,GADqC;AAErCQ,MAAAA,MAAM,EAANA,MAFqC;AAGrCL,MAAAA,KAAK,EAALA,KAHqC;AAIrCE,MAAAA,KAAK,EAALA,KAJqC;AAKrCH,MAAAA,KAAK,EAALA;AALqC,KAAjB,CAAtB,CAX4B,CAmB5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2BAAM;AACJS,MAAAA,aAAa,EAAbA,aADI;AAEJC,MAAAA,OAFI,qBAEM;AACRL,QAAAA,OAAO;AACR,OAJG;AAKJM,MAAAA,IALI,gBAKCC,GALD,EAKM;AACRC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACD;AAPG,KAAN;AASD,GA1CM,CAAP;AA2CD","sourcesContent":["import { resolve } from 'path';\nimport build from './utils/webpack/build';\n// import BuildStatistics from 'build-statistics-webpack-plugin';\n// import BigBrother from 'bigbrother-webpack-plugin';\nimport getUserConfig from './utils/getConfig/getUserConfig';\nimport getWebpackConfig from './utils/getWebpackConfig';\nimport getPaths from './utils/common/getPaths';\nimport registerBabel from './utils/babel/registerBabel';\n\nconst debug = require('debug')('zus:build');\n\nexport default function(opts = {}) {\n  const { cwd = process.cwd(), entry } = opts;\n\n  const babel = resolve(__dirname, './utils/babel/babel.js');\n  const paths = getPaths(cwd);\n  // const stagesPath = join(__dirname, '../.run/build-statistics/compilation.json');\n\n  // eslint-disable-next-line global-require,import/no-dynamic-require\n  // const zusPkg = require(join(__dirname, '../package.json'));\n\n  return new Promise(resolve => {\n    // register babel for config files\n    registerBabel(babel, {\n      cwd,\n    });\n\n    // get user config\n    const { config } = getUserConfig({ cwd });\n    debug(`user config: ${JSON.stringify(config)}`);\n\n    // get webpack config\n    const webpackConfig = getWebpackConfig({\n      cwd,\n      config,\n      babel,\n      paths,\n      entry,\n    });\n\n    // webpackConfig.plugins.push(\n    //   new BuildStatistics({\n    //     path: stagesPath,\n    //   }),\n    //   new BigBrother({\n    //     cwd,\n    //     tool: {\n    //       name: 'zus',\n    //       version: zusPkg.version,\n    //       stagesPath,\n    //     },\n    //   }),\n    // );\n\n    build({\n      webpackConfig,\n      success() {\n        resolve();\n      },\n      fail(err) {\n        console.log(err);\n      },\n    });\n  });\n}\n"],"file":"build.js"}