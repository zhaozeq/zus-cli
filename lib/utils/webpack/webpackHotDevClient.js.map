{"version":3,"sources":["../../../src/utils/webpack/webpackHotDevClient.js"],"names":["stripAnsi","require","url","launchEditorEndpoint","formatWebpackMessages","ErrorOverlay","socket","stripLastSlash","str","slice","setEditorHandler","editorHandler","errorLocation","fetch","window","encodeURIComponent","fileName","lineNumber","hadRuntimeError","startReportingRuntimeErrors","onError","module","hot","dispose","stopReportingRuntimeErrors","process","env","SOCKET_SERVER","format","protocol","location","hostname","port","pathname","onclose","console","info","onmessage","e","message","JSON","parse","data","type","handleAvailableHash","handleSuccess","reload","handleWarnings","handleErrors","isFirstCompilation","mostRecentCompilationHash","hasCompileErrors","clearOutdatedErrors","clear","isHotUpdate","tryApplyUpdates","onHotUpdateSuccess","dismissBuildError","warnings","printWarnings","formatted","errors","warn","i","length","onSuccessfulHotUpdate","reportBuildError","error","hash","isUpdateAvailable","__webpack_hash__","canApplyUpdates","status","HMR","handleApplyUpdates","err","updatedModules","result","check","then"],"mappings":"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","sourcesContent":["/* eslint-disable */\n/**\n * Copyright (c) 2015-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n// This alternative WebpackDevServer combines the functionality of:\n// https://github.com/webpack/webpack-dev-server/blob/webpack-1/client/index.js\n// https://github.com/webpack/webpack/blob/webpack-1/hot/dev-server.js\n\n// It only supports their simplest configuration (hot updates on same server).\n// It makes some opinionated choices on top, like adding a syntax error overlay\n// that looks similar to our console output. The error overlay is inspired by:\n// https://github.com/glenjamin/webpack-hot-middleware\n\nvar stripAnsi = require('strip-ansi');\nvar url = require('url');\nvar launchEditorEndpoint = require('react-dev-utils/launchEditorEndpoint');\nvar formatWebpackMessages = require('./formatWebpackMessages');\nvar ErrorOverlay = require('react-error-overlay');\nvar socket = require('./socket');\n\nfunction stripLastSlash(str) {\n  return str.slice(-1) === '/' ? str.slice(0, -1) : str;\n}\nErrorOverlay.setEditorHandler(function editorHandler(errorLocation) {\n  // Keep this sync with errorOverlayMiddleware.js\n  fetch(\n    `${launchEditorEndpoint}?fileName=` +\n      window.encodeURIComponent(errorLocation.fileName) +\n      '&lineNumber=' +\n      window.encodeURIComponent(errorLocation.lineNumber || 1),\n  );\n});\n\n// We need to keep track of if there has been a runtime error.\n// Essentially, we cannot guarantee application state was not corrupted by the\n// runtime error. To prevent confusing behavior, we forcibly reload the entire\n// application. This is handled below when we are notified of a compile (code\n// change).\n// See https://github.com/facebookincubator/create-react-app/issues/3096\nvar hadRuntimeError = false;\nErrorOverlay.startReportingRuntimeErrors({\n  onError: function() {\n    hadRuntimeError = true;\n  },\n});\n\nif (module.hot && typeof module.hot.dispose === 'function') {\n  module.hot.dispose(function() {\n    // TODO: why do we need this?\n    ErrorOverlay.stopReportingRuntimeErrors();\n  });\n}\n\n// Connect to WebpackDevServer via a socket.\nif (process.env.SOCKET_SERVER !== 'none') {\n  // console.log(window, 'window3')\n  socket(\n    process.env.SOCKET_SERVER\n      ? `${stripLastSlash(process.env.SOCKET_SERVER)}/sockjs-node`\n      : url.format({\n          protocol: window.location.protocol,\n          hostname: window.location.hostname,\n          port: window.location.port,\n          // Hardcoded in WebpackDevServer\n          pathname: '/sockjs-node',\n        }),\n    {\n      onclose() {\n        if (typeof console !== 'undefined' && typeof console.info === 'function') {\n          console.info('The development server has disconnected.\\nRefresh the page if necessary.');\n        }\n      },\n      onmessage(e) {\n        var message = JSON.parse(e.data);\n        switch (message.type) {\n          case 'hash':\n            handleAvailableHash(message.data);\n            break;\n          case 'still-ok':\n          case 'ok':\n            handleSuccess();\n            break;\n          case 'content-changed':\n            // Triggered when a file from `contentBase` changed.\n            window.location.reload();\n            break;\n          case 'warnings':\n            handleWarnings(message.data);\n            break;\n          case 'errors':\n            handleErrors(message.data);\n            break;\n          default:\n          // Do nothing.\n        }\n      },\n    },\n  );\n}\n\n// Remember some state related to hot module replacement.\nvar isFirstCompilation = true;\nvar mostRecentCompilationHash = null;\nvar hasCompileErrors = false;\n\nfunction clearOutdatedErrors() {\n  // Clean up outdated compile errors, if any.\n  if (typeof console !== 'undefined' && typeof console.clear === 'function') {\n    if (hasCompileErrors) {\n      console.clear();\n    }\n  }\n}\n\n// Successful compilation.\nfunction handleSuccess() {\n  clearOutdatedErrors();\n\n  var isHotUpdate = !isFirstCompilation;\n  isFirstCompilation = false;\n  hasCompileErrors = false;\n\n  // Attempt to apply hot updates or reload.\n  if (isHotUpdate) {\n    tryApplyUpdates(function onHotUpdateSuccess() {\n      // Only dismiss it when we're sure it's a hot update.\n      // Otherwise it would flicker right before the reload.\n      ErrorOverlay.dismissBuildError();\n    });\n  }\n}\n\n// Compilation with warnings (e.g. ESLint).\nfunction handleWarnings(warnings) {\n  clearOutdatedErrors();\n\n  var isHotUpdate = !isFirstCompilation;\n  isFirstCompilation = false;\n  hasCompileErrors = false;\n\n  function printWarnings() {\n    // Print warnings to the console.\n    var formatted = formatWebpackMessages({\n      warnings: warnings,\n      errors: [],\n    });\n\n    if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n      for (var i = 0; i < formatted.warnings.length; i++) {\n        if (i === 5) {\n          console.warn(\n            'There were more warnings in other files.\\n' +\n              'You can find a complete log in the terminal.',\n          );\n          break;\n        }\n        console.warn(stripAnsi(formatted.warnings[i]));\n      }\n    }\n  }\n\n  // Attempt to apply hot updates or reload.\n  if (isHotUpdate) {\n    tryApplyUpdates(function onSuccessfulHotUpdate() {\n      // Only print warnings if we aren't refreshing the page.\n      // Otherwise they'll disappear right away anyway.\n      printWarnings();\n      // Only dismiss it when we're sure it's a hot update.\n      // Otherwise it would flicker right before the reload.\n      ErrorOverlay.dismissBuildError();\n    });\n  } else {\n    // Print initial warnings immediately.\n    printWarnings();\n  }\n}\n\n// Compilation with errors (e.g. syntax error or missing modules).\nfunction handleErrors(errors) {\n  clearOutdatedErrors();\n\n  isFirstCompilation = false;\n  hasCompileErrors = true;\n\n  // \"Massage\" webpack messages.\n  var formatted = formatWebpackMessages({\n    errors: errors,\n    warnings: [],\n  });\n\n  // Only show the first error.\n  ErrorOverlay.reportBuildError(formatted.errors[0]);\n\n  // Also log them to the console.\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    for (var i = 0; i < formatted.errors.length; i++) {\n      console.error(stripAnsi(formatted.errors[i]));\n    }\n  }\n\n  // Do not attempt to reload now.\n  // We will reload on next success instead.\n}\n\n// There is a newer version of the code available.\nfunction handleAvailableHash(hash) {\n  // Update last known compilation hash.\n  mostRecentCompilationHash = hash;\n}\n\n// Is there a newer version of this code available?\nfunction isUpdateAvailable() {\n  /* globals __webpack_hash__ */\n  // __webpack_hash__ is the hash of the current compilation.\n  // It's a global variable injected by Webpack.\n  return mostRecentCompilationHash !== __webpack_hash__;\n}\n\n// Webpack disallows updates in other states.\nfunction canApplyUpdates() {\n  return module.hot.status() === 'idle';\n}\n\n// Attempt to update code on the fly, fall back to a hard reload.\nfunction tryApplyUpdates(onHotUpdateSuccess) {\n  if (process.env.HMR === 'reload' || !module.hot) {\n    // HotModuleReplacementPlugin is not in Webpack configuration.\n    window.location.reload();\n    return;\n  }\n\n  if (!isUpdateAvailable() || !canApplyUpdates()) {\n    return;\n  }\n\n  function handleApplyUpdates(err, updatedModules) {\n    if (err || !updatedModules || hadRuntimeError) {\n      window.location.reload();\n      return;\n    }\n\n    if (typeof onHotUpdateSuccess === 'function') {\n      // Maybe we want to do something.\n      onHotUpdateSuccess();\n    }\n\n    if (isUpdateAvailable()) {\n      // While we were updating, there was a new update! Do it again.\n      tryApplyUpdates();\n    }\n  }\n\n  // https://webpack.github.io/docs/hot-module-replacement.html#check\n  var result = module.hot.check(/* autoApply */ true, handleApplyUpdates);\n\n  // // Webpack 2 returns a Promise instead of invoking a callback\n  if (result && result.then) {\n    result.then(\n      function(updatedModules) {\n        handleApplyUpdates(null, updatedModules);\n      },\n      function(err) {\n        handleApplyUpdates(err, null);\n      },\n    );\n  }\n}\n"],"file":"webpackHotDevClient.js"}