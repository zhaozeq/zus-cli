{"version":3,"sources":["../../../../src/utils/getConfig/getConfig/index.js"],"names":["makeArray","item","Array","isArray","opts","cwd","isDev","process","env","NODE_ENV","webpackConfig","Config","mode","entry","key","forEach","file","add","Object","keys","absOutputPath","outputPath","output","path","filename","chunkFilename","publicPath","undefined","devtoolModuleFilenameTemplate","info","absoluteResourcePath","replace","resolve","set","modules","__dirname","end","extensions","merge","alias","resolveLoader","disableDynamicImport","__FROM_UMI_TEST","optimization","splitChunks","chunks","name","runtimeChunk","DEFAULT_INLINE_LIMIT","rule","module","exclude","urlLoaderExcludes","use","loader","require","options","limit","inlineLimit","babelOptsCommon","sourceType","cacheDirectory","BABEL_CACHE","babelrc","BABELRC","customize","babel","babelOpts","presets","extraBabelPresets","plugins","extraBabelPlugins","loaderMap","svg","ReactComponent","ESLINT","test","type","include","extraBabelIncludes","push","a","includes","pkgPath","index","tsConfigFile","configFile","transpileOnly","errorFormatter","error","colors","messageColor","severity","bold","yellow","red","grey","toUpperCase","cyan","context","line","character","EOL","code","content","typescript","plugin","NO_PROGRESS","PROGRESS","CI","platform","color","reporters","ignoreMomentLocale","ANALYZE","BundleAnalyzerPlugin","analyzerMode","analyzerPort","ANALYZE_PORT","openAnalyzer","generateStatsFile","ANALYZE_DUMP","statsFilename","DUPLICATE_CHECKER","FORK_TS_CHECKER","formatter","from","to","toType","copy","CLEAR_CONSOLE","clearConsole","externals","node","setImmediate","dgram","fs","net","tls","child_process","chainConfig","config","toConfig","SPEED_MEASURE","SpeedMeasurePlugin","smpOption","outputFormat","outputTarget","console","log","smp","wrap"],"mappings":"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","sourcesContent":["/* eslint-disable global-require */\nimport Config from 'webpack-chain';\nimport { join, resolve, relative } from 'path';\nimport { existsSync } from 'fs';\nimport { EOL } from 'os';\nimport assert from 'assert';\nimport { getPkgPath, shouldTransform } from './es5ImcompatibleVersions';\nimport resolveDefine from './resolveDefine';\n\nfunction makeArray(item) {\n  if (Array.isArray(item)) return item;\n  return [item];\n}\n\n/**\n * 链式生成webpack配置\n */\nexport default function(opts) {\n  const { cwd } = opts;\n  const isDev = process.env.NODE_ENV === 'development';\n\n  const webpackConfig = new Config();\n\n  // mode\n  webpackConfig.mode('development');\n\n  // entry\n  if (opts.entry) {\n    for (const key of Object.keys(opts.entry)) {\n      const entry = webpackConfig.entry(key);\n      makeArray(opts.entry[key]).forEach(file => {\n        entry.add(file);\n      });\n    }\n  }\n\n  // output\n  const absOutputPath = resolve(cwd, opts.outputPath || 'dist');\n  webpackConfig.output\n    .path(absOutputPath)\n    .filename(`[name].js`)\n    .chunkFilename(`[name].async.js`)\n    .publicPath(opts.publicPath || undefined)\n    .devtoolModuleFilenameTemplate(info => {\n      return relative(opts.cwd, info.absoluteResourcePath).replace(/\\\\/g, '/');\n    });\n\n  // resolve\n  webpackConfig.resolve\n    // 不能设为 false，因为 tnpm 是通过 link 处理依赖，设为 false tnpm 下会有大量的冗余模块\n    .set('symlinks', true)\n    .modules.add('node_modules')\n    .add(join(__dirname, '../../../../node_modules'))\n    // Fix yarn global resolve problem\n    // .add(join(__dirname, '../../../../'))\n    .end()\n    .extensions.merge([\n      '.web.js',\n      '.wasm',\n      '.mjs',\n      '.js',\n      '.web.jsx',\n      '.jsx',\n      '.web.ts',\n      '.ts',\n      '.web.tsx',\n      '.tsx',\n      '.json',\n    ]);\n\n  if (opts.alias) {\n    for (const key of Object.keys(opts.alias)) {\n      webpackConfig.resolve.alias.set(key, opts.alias[key]);\n    }\n  }\n\n  // resolveLoader\n  webpackConfig.resolveLoader.modules\n    .add('node_modules')\n    // .add(join(__dirname, '../../../../node_modules'))\n    .end();\n\n  if (!opts.disableDynamicImport && !process.env.__FROM_UMI_TEST) {\n    webpackConfig.optimization\n      .splitChunks({\n        chunks: 'async',\n        name: 'vendors',\n      })\n      .runtimeChunk(false);\n  }\n\n  // module -> exclude\n  const DEFAULT_INLINE_LIMIT = 10000;\n  const rule = webpackConfig.module\n    .rule('exclude')\n    .exclude.add(/\\.json$/)\n    .add(/\\.(js|jsx|ts|tsx|mjs|wasm)$/)\n    .add(/\\.(css|less|scss|sass)$/);\n  if (opts.urlLoaderExcludes) {\n    opts.urlLoaderExcludes.forEach(exclude => {\n      rule.add(exclude);\n    });\n  }\n  rule\n    .end()\n    .use('url-loader')\n    .loader(require.resolve('umi-url-pnp-loader'))\n    .options({\n      limit: opts.inlineLimit || DEFAULT_INLINE_LIMIT,\n      name: 'static/[name].[hash:8].[ext]',\n    });\n\n  const babelOptsCommon = {\n    // Tell babel to guess the type, instead assuming all files are modules\n    // https://github.com/webpack/webpack/issues/4039#issuecomment-419284940\n    sourceType: 'unambiguous',\n    cacheDirectory: process.env.BABEL_CACHE !== 'none', // enable by default\n    babelrc: !!process.env.BABELRC, // disable by default\n    customize: require.resolve('../../webpack/weboack-overrides.js'),\n  };\n  const babel = opts.babel || {};\n  const babelOpts = {\n    presets: [...(babel.presets || []), ...(opts.extraBabelPresets || [])],\n    plugins: [\n      ...(babel.plugins || []),\n      ...(opts.extraBabelPlugins || []),\n      [\n        require.resolve('babel-plugin-named-asset-import'),\n        {\n          loaderMap: {\n            svg: {\n              ReactComponent: `${require.resolve('../svgr')}?-prettier,-svgo![path]`,\n            },\n          },\n        },\n      ],\n    ],\n    ...babelOptsCommon,\n  };\n\n  if (opts.disableDynamicImport) {\n    babelOpts.plugins = [\n      ...(babelOpts.plugins || []),\n      require.resolve('babel-plugin-dynamic-import-node'),\n    ];\n  }\n\n  // module -> eslint\n  if (process.env.ESLINT && process.env.ESLINT !== 'none') {\n    require('./eslint').default(webpackConfig, opts);\n  }\n\n  // Avoid \"require is not defined\" errors\n  webpackConfig.module\n    .rule('mjs-require')\n    .test(/\\.mjs$/)\n    .type('javascript/auto')\n    .include.add(opts.cwd);\n\n  // module -> mjs\n  webpackConfig.module\n    .rule('mjs')\n    .test(/\\.mjs$/)\n    .include.add(opts.cwd)\n    .end()\n    .use('babel-loader')\n    .loader(require.resolve('babel-loader'))\n    .options(babelOpts);\n\n  // module -> js\n  webpackConfig.module\n    .rule('js')\n    .test(/\\.js$/)\n    .include.add(opts.cwd)\n    .end()\n    .exclude.add(/node_modules/)\n    .end()\n    .use('babel-loader')\n    .loader(require.resolve('babel-loader'))\n    .options(babelOpts);\n\n  // module -> jsx\n  // jsx 不 exclude node_modules\n  webpackConfig.module\n    .rule('jsx')\n    .test(/\\.jsx$/)\n    .include.add(opts.cwd)\n    .end()\n    .use('babel-loader')\n    .loader(require.resolve('babel-loader'))\n    .options(babelOpts);\n\n  // module -> extraBabelIncludes\n  // suport es5ImcompatibleVersions\n  const extraBabelIncludes = opts.extraBabelIncludes || [];\n  extraBabelIncludes.push(a => {\n    if (!a.includes('node_modules')) return false;\n    const pkgPath = getPkgPath(a);\n    return shouldTransform(pkgPath);\n  });\n  extraBabelIncludes.forEach((include, index) => {\n    const rule = `extraBabelInclude_${index}`;\n    webpackConfig.module\n      .rule(rule)\n      .test(/\\.jsx?$/)\n      .include.add(include)\n      .end()\n      .use('babel-loader')\n      .loader(require.resolve('babel-loader'))\n      .options(babelOpts);\n  });\n\n  // module -> tsx?\n  const tsConfigFile = opts.tsConfigFile || join(opts.cwd, 'tsconfig.json');\n  webpackConfig.module\n    .rule('ts')\n    .test(/\\.tsx?$/)\n    .use('babel-loader')\n    .loader(require.resolve('babel-loader'))\n    .options(babelOpts)\n    .end()\n    .use('ts-loader')\n    .loader(require.resolve('ts-loader'))\n    .options({\n      configFile: tsConfigFile,\n      transpileOnly: true,\n      // ref: https://github.com/TypeStrong/ts-loader/blob/fbed24b/src/utils.ts#L23\n      errorFormatter(error, colors) {\n        const messageColor = error.severity === 'warning' ? colors.bold.yellow : colors.bold.red;\n        return (\n          colors.grey('[tsl] ')\n          + messageColor(error.severity.toUpperCase())\n          + (error.file === ''\n            ? ''\n            : messageColor(' in ')\n              + colors.bold.cyan(\n                `${relative(cwd, join(error.context, error.file))}(${error.line},${\n                  error.character\n                })`,\n              ))\n          + EOL\n          + messageColor(`      TS${error.code}: ${error.content}`)\n        );\n      },\n      ...(opts.typescript || {}),\n    });\n\n  // module -> css\n  require('./css').default(webpackConfig, opts);\n\n  // plugins -> define\n  webpackConfig.plugin('define').use(require('webpack/lib/DefinePlugin'), [resolveDefine(opts)]);\n\n  // plugins -> progress bar\n  const NO_PROGRESS = process.env.PROGRESS === 'none';\n  if (!process.env.__FROM_UMI_TEST) {\n    if (!process.env.CI && !NO_PROGRESS) {\n      if (process.platform === 'win32') {\n        webpackConfig.plugin('progress').use(require('progress-bar-webpack-plugin'));\n      } else {\n        webpackConfig.plugin('progress').use(require('webpackbar'), [\n          {\n            color: 'green',\n            reporters: ['fancy'],\n          },\n        ]);\n      }\n    }\n  }\n\n  // plugins -> ignore moment locale\n  if (opts.ignoreMomentLocale) {\n    webpackConfig\n      .plugin('ignore-moment-locale')\n      .use(require('webpack/lib/IgnorePlugin'), [/^\\.\\/locale$/, /moment$/]);\n  }\n\n  // plugins -> analyze\n  if (process.env.ANALYZE) {\n    webpackConfig\n      .plugin('bundle-analyzer')\n      .use(require('webpack-bundle-analyzer').BundleAnalyzerPlugin, [\n        {\n          analyzerMode: 'server',\n          analyzerPort: process.env.ANALYZE_PORT || 8888,\n          openAnalyzer: true,\n          // generate stats file while ANALYZE_DUMP exist\n          generateStatsFile: !!process.env.ANALYZE_DUMP,\n          statsFilename: process.env.ANALYZE_DUMP || 'stats.json',\n        },\n      ]);\n  }\n\n  if (process.env.DUPLICATE_CHECKER) {\n    webpackConfig\n      .plugin('duplicate-package-checker')\n      .use(require('duplicate-package-checker-webpack-plugin'));\n  }\n\n  if (process.env.FORK_TS_CHECKER) {\n    webpackConfig.plugin('fork-ts-checker').use(require('fork-ts-checker-webpack-plugin'), [\n      {\n        formatter: 'codeframe',\n      },\n    ]);\n  }\n\n  // plugins -> copy\n  if (existsSync(join(opts.cwd, 'public'))) {\n    webpackConfig.plugin('copy-public').use(require('copy-webpack-plugin'), [\n      [\n        {\n          from: join(opts.cwd, 'public'),\n          to: absOutputPath,\n          toType: 'dir',\n        },\n      ],\n    ]);\n  }\n  if (opts.copy) {\n    makeArray(opts.copy).forEach((copy, index) => {\n      if (typeof copy === 'string') {\n        copy = {\n          from: join(opts.cwd, copy),\n          to: absOutputPath,\n        };\n      }\n      webpackConfig.plugin(`copy-${index}`).use(require('copy-webpack-plugin'), [[copy]]);\n    });\n  }\n\n  if (!process.env.__FROM_UMI_TEST) {\n    // filter `Conflicting order between` warning\n    webpackConfig\n      .plugin('filter-css-conflicting-warnings')\n      .use(require('./FilterCSSConflictingWarning').default);\n\n    // plugins -> friendly-errors\n    const { CLEAR_CONSOLE = 'none' } = process.env;\n    webpackConfig.plugin('friendly-errors').use(require('friendly-errors-webpack-plugin'), [\n      {\n        clearConsole: CLEAR_CONSOLE !== 'none',\n      },\n    ]);\n  }\n\n  // externals\n  if (opts.externals) {\n    webpackConfig.externals(opts.externals);\n  }\n\n  // node\n  webpackConfig.node.merge({\n    setImmediate: false,\n    process: 'mock',\n    dgram: 'empty',\n    fs: 'empty',\n    net: 'empty',\n    tls: 'empty',\n    child_process: 'empty',\n  });\n\n  if (isDev) {\n    require('./dev').default(webpackConfig, opts);\n  } else {\n    require('./prod').default(webpackConfig, opts);\n  }\n\n  if (opts.chainConfig) {\n    assert(\n      typeof opts.chainConfig === 'function',\n      `opts.chainConfig should be function, but got ${opts.chainConfig}`,\n    );\n    opts.chainConfig(webpackConfig);\n  }\n  let config = webpackConfig.toConfig();\n  if (process.env.SPEED_MEASURE) {\n    const SpeedMeasurePlugin = require('speed-measure-webpack-plugin');\n    const smpOption = process.env.SPEED_MEASURE === 'CONSOLE'\n        ? { outputFormat: 'human', outputTarget: console.log }\n        : {\n            outputFormat: 'json',\n            outputTarget: join(process.cwd(), 'speed-measure.json'),\n          };\n    const smp = new SpeedMeasurePlugin(smpOption);\n    config = smp.wrap(config);\n  }\n  return config;\n}\n"],"file":"index.js"}