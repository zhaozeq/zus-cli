{"version":3,"sources":["../../../src/utils/babel/registerBabel.js"],"names":["babelPreset","opts","ignore","cwd","files","map","file","only","RegExp","join","registerBabel","process","env","NODE_ENV","require","presets","plugins","extensions","babelrc","cache"],"mappings":";;;;;;;;;AAAA;;AACA;;AAAgD;AAEjC,kBAASA,WAAT,EAAsBC,IAAtB,EAA4B;AAAA,MACjCC,MADiC,GACjBD,IADiB,CACjCC,MADiC;AAAA,MACzBC,GADyB,GACjBF,IADiB,CACzBE,GADyB;AAEzC,MAAMC,KAAK,GAAG,CAAC,cAAD,EAAiB,eAAjB,EAAkC,mBAAlC,EAAuD,MAAvD,EAA+D,KAA/D,EAAsEC,GAAtE,CAA0E,UAAAC,IAAI,EAAI;AAC9F,WAAO,wBAAa,gBAAKH,GAAL,EAAUG,IAAV,CAAb,CAAP;AACD,GAFa,CAAd;AAGA,MAAMC,IAAI,GAAG,CAAC,IAAIC,MAAJ,YAAeJ,KAAK,CAACK,IAAN,CAAW,GAAX,CAAf,OAAD,CAAb;AAEAC,EAAAA,aAAa,CAAC;AACZH,IAAAA,IAAI,EAAJA,IADY;AAEZL,IAAAA,MAAM,EAANA,MAFY;AAGZF,IAAAA,WAAW,EAAXA;AAHY,GAAD,CAAb;AAKD;;AAED,SAASU,aAAT,GAAkC;AAAA,MAAXT,IAAW,uEAAJ,EAAI;AAAA,MACxBM,IADwB,GACMN,IADN,CACxBM,IADwB;AAAA,MAClBL,MADkB,GACMD,IADN,CAClBC,MADkB;AAAA,MACVF,WADU,GACMC,IADN,CACVD,WADU;;AAEhC,MAAIW,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,MAA7B,EAAqC;AACnC;AACAC,IAAAA,OAAO,CAAC,iBAAD,CAAP,CAA2B;AACzBC,MAAAA,OAAO,EAAE,CAACf,WAAD,CADgB;AAEzBgB,MAAAA,OAAO,EAAE,EAFgB;AAGzBT,MAAAA,IAAI,EAAJA,IAHyB;AAIzBL,MAAAA,MAAM,EAANA,MAJyB;AAKzBe,MAAAA,UAAU,EAAE,CAAC,MAAD,EAAS,KAAT,EAAgB,MAAhB,EAAwB,KAAxB,EAA+B,MAA/B,EAAuC,KAAvC,EAA8C,MAA9C,CALa;AAMzBC,MAAAA,OAAO,EAAE,KANgB;AAOzBC,MAAAA,KAAK,EAAE;AAPkB,KAA3B;AASD;AACF","sourcesContent":["import { join } from 'path';\nimport excapeRegExp from 'lodash.escaperegexp'; // 转义字符串中的特殊字符避免影响正则校验\n\nexport default function(babelPreset, opts) {\n  const { ignore, cwd } = opts;\n  const files = ['.zus.mock.js', '.webpackrc.js', 'webpack.config.js', 'mock', 'src'].map(file => {\n    return excapeRegExp(join(cwd, file));\n  });\n  const only = [new RegExp(`(${files.join('|')})`)];\n\n  registerBabel({\n    only,\n    ignore,\n    babelPreset,\n  });\n}\n\nfunction registerBabel(opts = {}) {\n  const { only, ignore, babelPreset } = opts;\n  if (process.env.NODE_ENV !== 'test') {\n    // eslint-disable-next-line global-require\n    require('@babel/register')({\n      presets: [babelPreset],\n      plugins: [],\n      only,\n      ignore,\n      extensions: ['.es6', '.es', '.jsx', '.js', '.mjs', '.ts', '.tsx'],\n      babelrc: false,\n      cache: false,\n    });\n  }\n}\n"],"file":"registerBabel.js"}